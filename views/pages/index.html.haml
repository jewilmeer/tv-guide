.two-third-column
  .slides
    .slides_container
      - @featured_programs.each do |program|
        - image = program.fanart_image || program.images.fanart.random.first
        .slide
          = link_to program do
            = image_tag "#{image.id}.jpg", :alt => program.name, :size => '655x368'
            .caption
              %h4= program.name
              %p= truncate(program.overview, :length => 150)
      -# Program.by_updated_at.limit(2).map(&:images).map(&:fanart).map(&:random).map(&:only_id).map(&:first).each do |image|
        .slide
          = link_to image.programs.first do
            = image_tag "#{image.id}.jpg", :alt => image.programs.first.name, :size => '655x368'
  .row_seperator
  .column-block
    %h1 
      - if current_user
        == Welcome #{current_user.login.humanize}
      - else
        Welcome guest
    .body
      %p
        Do you want to be able to follow your 'watched on the internet' series as easy as possible? Just signup for an account and enjoy!
        All Data will be updated from thetvdb.com and will be as fresh as possible. Keep an eye on the 'program updates' in the footer to see which series are recently updated.
      %p
        %strong Note
        This website is a hobby project and may not always work as excepted. Help and suggestions are always welcome. As of the free Heroku hosting, connectivity is limited (only 1 concurrent connection).
.third-column.flt-right
  - cache([:upcomming_5, Program.by_updated_at.last, Episode.next_airing.first]) do # program cache key will expire this fragment if any update is received
    .column-block
      %h3.no_bottom_margin
        %span.header Upcomming episodes
        .header_link= link_to 'Full Guide', guide_programs_path
      .body
        - if @upcoming_episodes.any?
          %ul.list.mini_guide= render :partial => 'episodes/episode', :collection => @upcoming_episodes, :locals => {:simple => true}
        - else
          %p.nothing No upcoming episodes known
  - cache([:last_5_added, Episode.by_created_at.last], :expires_in => 10.minutes) do
    .column-block
      %h3.no_bottom_margin
        %span.header Last added episodes
        .header_link= link_to 'More updates', pages_program_updates_path
      .body
        - if @latest_episodes.any?
          %ul.list.mini_guide= render :partial => 'episodes/episode', :collection => @latest_episodes, :locals => {:addition_info => :created_at, :simple => true}
        - else
          %p.nothing No latest additions found
      