.two-third-column
  .slides
    .slides_container
      - @featured_programs.each do |program|
        - image = program.fanart_image || program.images.fanart.random.first
        .slide
          = link_to program do
            = image_tag "#{image.id}.jpg", :alt => program.name, :size => '655x368'
            .caption
              %h4= program.name
              %p= truncate(program.overview, :length => 190)
  .row_seperator
  .column-block
    %h1 
      - if current_user
        == Welcome #{current_user.login.humanize}
      - else
        Welcome guest
    .body
      %p
        Do you want to be able to follow your 'watched on the internet' series as easy as possible? Just signup for an account and enjoy!
        All Data will be updated from thetvdb.com and will be as fresh as possible. Keep an eye on the 'program updates' in the footer to see which series are recently updated.
      %p
        %strong Note
        This website is a hobby project and may not always work as excepted. Help and suggestions are always welcome. As of the free Heroku hosting, connectivity is limited (only 1 concurrent connection).
.third-column.flt-right
  - cache([:next_airing, Episode.next_airing.first]) do # program cache key will expire this fragment if any update is received
    .column-block
      %h2.no_bottom_margin
        %span.header Next Airing Episodes
        .header_link= link_to 'Full Guide', guide_programs_path
      .body
        - if @next_airing.any?
          - last_date = nil
          %ul.list.mini_guide
            - @next_airing.each do |episode|
              - unless last_date == episode.airs_at.to_date
                - last_date = episode.airs_at.to_date
                %li.header
                  %h4= l last_date, :format => :with_day
              %li
                = link_to episode.program_name, program_path(episode.program_id)
                \-
                = link_to episode.title
                == (#{episode.season_and_episode})
              
        - else
          %p.nothing No upcoming episodes known
  - cache([:last_aired, Episode.last_aired.first]) do
    .column-block
      %h2.no_bottom_margin
        %span.header Last Aired Episodes
        .header_link= link_to 'Full Guide', guide_programs_path
      .body
        - if @last_aired.any?
          - last_date = nil
          %ul.list.mini_guide
            - @last_aired.each do |episode|
              - unless last_date == episode.airs_at.to_date
                - last_date = episode.airs_at.to_date
                %li.header
                  %h4= l last_date, :format => :with_day
              %li
                = link_to episode.program_name, program_path(episode.program_id)
                \-
                = link_to episode.title
                == (#{episode.season_and_episode})
        - else
          %p.nothing No latest additions found
      