.topbar
  .topbar-inner
    .container
      %h3 
        = link_to 'Digital TV Guide', root_path
      %nav
        %ul.nav
          %li= link_to 'Home', root_path
          %li= link_to 'Guide', guide_programs_path
          %li= link_to 'Programs', :programs
          
        = form_tag programs_path, :method => 'get', :id => "programs_search" do
          %input{:type => :text, :placeholder => 'Program name', :name => :q, :value => params[:q], :data => {:'disable-with' => 'Searching...'}}
          = hidden_field_tag :direction, params[:direction]
          = hidden_field_tag :sort, params[:sort]

        %ul.nav.secondary-nav
          - if current_user
            %li.dropdown{:data => {:dropdown => :dropdown}}
              = link_to '#', :class => :'dropdown-toggle' do 
                / = image_tag(current_user.gravatar_url(20).html_safe)
                = current_user.login.humanize
              %ul.dropdown-menu
                %li= link_to 'Guide & Programs', [current_user, :programs]
                %li= link_to "Account", edit_user_path(current_user)
                - if current_user.admin?
                  %li.divider
                  -# %li= link_to "Active admin", active_admin_dashboard_path 
                  %li= link_to "Admin", admin_root_path
                %li.divider
                %li= link_to "Logout", logout_path
          - else
            %li= link_to 'Register', signup_path
            %li= link_to 'Login', login_path

            - if current_user
              %li= link_to 'Guide & Programs', [current_user, :programs]
              %li= link_to "Account", edit_user_path(current_user)
              - if current_user.admin?
                %li= link_to "Admin", admin_root_path
              %li= link_to "Logout", logout_path
          